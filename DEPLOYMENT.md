# XPanel éƒ¨ç½²æŒ‡å—

## ğŸš€ Cloudflare Pages éƒ¨ç½²æ­¥éª¤

### 1. å‡†å¤‡å·¥ä½œ

ç¡®ä¿ä½ å·²ç»ï¼š
- æ‹¥æœ‰ Cloudflare è´¦æˆ·
- å®‰è£…äº† Node.js 18+
- å®‰è£…äº† Wrangler CLI: `npm install -g wrangler`
- ç™»å½•äº† Cloudflare: `wrangler login`

### 2. åˆ›å»º D1 æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“
wrangler d1 create xpanel-db

# è®°å½•è¿”å›çš„æ•°æ®åº“ IDï¼Œæ›´æ–°åˆ° wrangler.toml æ–‡ä»¶ä¸­
```

### 3. æ›´æ–°é…ç½®æ–‡ä»¶

åœ¨ `wrangler.toml` ä¸­æ›´æ–°æ•°æ®åº“ IDï¼š

```toml
[[env.production.d1_databases]]
binding = "DB"
database_name = "xpanel-db"
database_id = "ä½ çš„æ•°æ®åº“ID"
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºè¡¨ç»“æ„
wrangler d1 execute xpanel-db --env production --file=./database/schema.sql

# æ’å…¥åˆå§‹æ•°æ®
wrangler d1 execute xpanel-db --env production --file=./database/seed.sql
```

### 5. æ„å»ºé¡¹ç›®

```bash
npm install
npm run build
```

### 6. éƒ¨ç½²åˆ° Cloudflare Pages

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Wrangler CLI

```bash
wrangler pages deploy dist --project-name=xpanel
```

#### æ–¹æ³•äºŒï¼šé€šè¿‡ Cloudflare Dashboard

1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥ Pages é¡µé¢
3. ç‚¹å‡» "Create a project"
4. è¿æ¥ä½ çš„ Git ä»“åº“
5. é…ç½®æ„å»ºè®¾ç½®ï¼š
   - æ„å»ºå‘½ä»¤: `npm run build`
   - æ„å»ºè¾“å‡ºç›®å½•: `dist`
   - Node.js ç‰ˆæœ¬: `18`

### 7. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
JWT_SECRET=your-super-secret-jwt-key-here
PAYMENT_SECRET=your-payment-callback-secret
```

### 8. ç»‘å®š D1 æ•°æ®åº“

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®çš„ Functions æ ‡ç­¾é¡µä¸­ï¼š
1. æ·»åŠ  D1 æ•°æ®åº“ç»‘å®š
2. å˜é‡å: `DB`
3. é€‰æ‹©ä½ åˆ›å»ºçš„ `xpanel-db` æ•°æ®åº“

## ğŸ”§ æ„å»ºé…ç½®

### Vite é…ç½®ä¼˜åŒ–

é¡¹ç›®å·²é…ç½®äº†ä»¥ä¸‹ä¼˜åŒ–ï¼š
- ä»£ç åˆ†å‰²
- èµ„æºå‹ç¼©
- ç°ä»£æµè§ˆå™¨æ”¯æŒ
- TypeScript æ”¯æŒ

### Functions é…ç½®

- TypeScript ç¼–è¯‘
- æ¨¡å—åŒ–è·¯ç”±
- é”™è¯¯å¤„ç†
- CORS æ”¯æŒ

## ğŸ›¡ï¸ å®‰å…¨é…ç½®

### å¿…é¡»é…ç½®çš„å®‰å…¨é¡¹

1. **JWT Secret**: ç”Ÿæˆå¼ºå¯†ç ç”¨äº JWT ç­¾å
2. **æ•°æ®åº“è®¿é—®**: ç¡®ä¿åªæœ‰æˆæƒçš„ Functions å¯ä»¥è®¿é—®
3. **CORS è®¾ç½®**: æ ¹æ®éœ€è¦é…ç½®è·¨åŸŸè®¿é—®
4. **é»˜è®¤ç®¡ç†å‘˜**: éƒ¨ç½²åç«‹å³ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 

### æ¨èçš„å®‰å…¨æªæ–½

1. å¯ç”¨ Cloudflare çš„å®‰å…¨åŠŸèƒ½ï¼š
   - Bot Fight Mode
   - Rate Limiting
   - DDoS Protection

2. é…ç½®è‡ªå®šä¹‰åŸŸåå’Œ SSL

3. è®¾ç½®è®¿é—®ç­–ç•¥å’Œé˜²ç«å¢™è§„åˆ™

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### Cloudflare Analytics

- å¯ç”¨ Web Analytics
- ç›‘æ§ Functions æ‰§è¡Œæƒ…å†µ
- æŸ¥çœ‹é”™è¯¯æ—¥å¿—

### æ€§èƒ½ç›‘æ§

- ä½¿ç”¨ Cloudflare çš„æ€§èƒ½åˆ†æ
- ç›‘æ§æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
- è®¾ç½®å‘Šè­¦è§„åˆ™

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### è‡ªåŠ¨éƒ¨ç½²

å¦‚æœä½¿ç”¨ Git é›†æˆï¼š
1. æ¨é€ä»£ç åˆ°ä¸»åˆ†æ”¯
2. Cloudflare Pages è‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²

### æ‰‹åŠ¨éƒ¨ç½²

```bash
npm run build
wrangler pages deploy dist --project-name=xpanel
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ„å»ºå¤±è´¥**
   - æ£€æŸ¥ Node.js ç‰ˆæœ¬
   - ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²å®‰è£…
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—

2. **Functions é”™è¯¯**
   - æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
   - ç¡®è®¤æ•°æ®åº“ç»‘å®š
   - æŸ¥çœ‹ Functions æ—¥å¿—

3. **æ•°æ®åº“è¿æ¥é—®é¢˜**
   - éªŒè¯æ•°æ®åº“ ID
   - æ£€æŸ¥ç»‘å®šé…ç½®
   - ç¡®è®¤æ•°æ®åº“å·²åˆå§‹åŒ–

### è°ƒè¯•æŠ€å·§

1. ä½¿ç”¨ `wrangler pages dev` æœ¬åœ°è°ƒè¯•
2. æŸ¥çœ‹ Cloudflare Dashboard ä¸­çš„æ—¥å¿—
3. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ£€æŸ¥ç½‘ç»œè¯·æ±‚

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] åˆ›å»º D1 æ•°æ®åº“
- [ ] æ›´æ–° wrangler.toml é…ç½®
- [ ] åˆå§‹åŒ–æ•°æ®åº“ç»“æ„å’Œæ•°æ®
- [ ] é…ç½®ç¯å¢ƒå˜é‡
- [ ] ç»‘å®š D1 æ•°æ®åº“
- [ ] æ„å»ºé¡¹ç›®æˆåŠŸ
- [ ] éƒ¨ç½²åˆ° Cloudflare Pages
- [ ] æµ‹è¯•ç½‘ç«™åŠŸèƒ½
- [ ] ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- [ ] é…ç½®è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰
- [ ] å¯ç”¨å®‰å…¨åŠŸèƒ½
- [ ] è®¾ç½®ç›‘æ§å’Œå‘Šè­¦

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ä»£ç åˆ†å‰²**: ä½¿ç”¨åŠ¨æ€å¯¼å…¥å‡å°‘åˆå§‹åŒ…å¤§å°
2. **ç¼“å­˜ç­–ç•¥**: é…ç½®é€‚å½“çš„ç¼“å­˜å¤´
3. **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ Cloudflare Images æˆ–å…¶ä»– CDN
4. **æ•°æ®åº“ä¼˜åŒ–**: æ·»åŠ é€‚å½“çš„ç´¢å¼•
5. **API ä¼˜åŒ–**: å®ç°åˆ†é¡µå’Œæ•°æ®è¿‡æ»¤

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ Cloudflare æ–‡æ¡£
2. æ£€æŸ¥é¡¹ç›® Issues
3. è”ç³»å¼€å‘å›¢é˜Ÿ